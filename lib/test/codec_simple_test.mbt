// Code generated by scripts/gen_codec_tests.py. DO NOT EDIT.

///|
fn decode_int32(b64 : String) -> Int raise {
  let bytes = @protobuf.base64_decode(b64)
  let reader = @protobuf.BytesReader::from_bytes(bytes) as &@protobuf.Reader
  let (tag, wire_type) = reader |> @protobuf.read_tag()
  assert_eq(tag, 1U)
  assert_eq(wire_type, 0U)
  reader |> @protobuf.read_int32()
}

///|
fn encode_int32(value : Int) -> String raise {
  let writer = @buffer.new()
  writer |> @protobuf.write_tag((1U, 0U))
  writer |> @protobuf.write_int32(value)
  writer.to_bytes() |> @protobuf.base64_encode
}

///|
test "simple/int32" {
  let cases : Array[(String, Int)] = [
    ("CAA=", 0),
    ("CAE=", 1),
    ("CP///////////wE=", -1),
    ("CAI=", 2),
    ("CP7//////////wE=", -2),
    ("CCo=", 42),
    ("CNb//////////wE=", -42),
    ("COgH", 1000),
    ("CJj4/////////wE=", -1000),
    ("CLlg", 12345),
    ("CMef/////////wE=", -12345),
    ("CH8=", 127),
    ("CIAB", 128),
    ("CP8B", 255),
    ("CIAC", 256),
    ("CP9/", 16383),
    ("CICAAQ==", 16384),
    ("CP//fw==", 2097151),
    ("CICAgAE=", 2097152),
    ("CP///38=", 268435455),
    ("CICAgIAB", 268435456),
    ("CICU69wD", 1000000000),
    ("CIDslKP8/////wE=", -1000000000),
    ("CJWa7zo=", 123456789),
    ("COvlkMX//////wE=", -123456789),
    ("CP////8H", 2147483647),
    ("CICAgID4/////wE=", -2147483648),
    ("CID//////////wE=", -128),
    ("CP/+/////////wE=", -129),
    ("CICA/////////wE=", -16384),
  ]
  for case in cases {
    let (b64, expected) = case
    assert_eq(decode_int32(b64), expected)
    assert_eq(encode_int32(expected), b64)
  }
}

///|
fn decode_int64(b64 : String) -> Int64 raise {
  let bytes = @protobuf.base64_decode(b64)
  let reader = @protobuf.BytesReader::from_bytes(bytes) as &@protobuf.Reader
  let (tag, wire_type) = reader |> @protobuf.read_tag()
  assert_eq(tag, 1U)
  assert_eq(wire_type, 0U)
  reader |> @protobuf.read_int64()
}

///|
fn encode_int64(value : Int64) -> String raise {
  let writer = @buffer.new()
  writer |> @protobuf.write_tag((1U, 0U))
  writer |> @protobuf.write_int64(value)
  writer.to_bytes() |> @protobuf.base64_encode
}

///|
test "simple/int64" {
  let cases : Array[(String, Int64)] = [
    ("CAA=", 0L),
    ("CAE=", 1L),
    ("CP///////////wE=", -1L),
    ("CAI=", 2L),
    ("CP7//////////wE=", -2L),
    ("CCo=", 42L),
    ("CNb//////////wE=", -42L),
    ("COgH", 1000L),
    ("CJj4/////////wE=", -1000L),
    ("CLlg", 12345L),
    ("CMef/////////wE=", -12345L),
    ("CH8=", 127L),
    ("CIAB", 128L),
    ("CP8B", 255L),
    ("CIAC", 256L),
    ("CP9/", 16383L),
    ("CICAAQ==", 16384L),
    ("CP//fw==", 2097151L),
    ("CICAgAE=", 2097152L),
    ("CP///38=", 268435455L),
    ("CICAgIAB", 268435456L),
    ("CP////9/", 34359738367L),
    ("CICAgICAAQ==", 34359738368L),
    ("CP//////fw==", 4398046511103L),
    ("CICAgICAgAE=", 4398046511104L),
    ("CP///////38=", 562949953421311L),
    ("CICAgICAgIAB", 562949953421312L),
    ("CP////////9/", 72057594037927935L),
    ("CICAgICAgICAAQ==", 72057594037927936L),
    ("CP////////8P", 9007199254740991L),
    ("CIGAgICAgIDw/wE=", -9007199254740991L),
    ("CPn824fDyOAB", 987654321012345L),
    ("CIeDpPi8t5/+/wE=", -987654321012345L),
    ("CP//////////fw==", 9223372036854775807L),
    ("CICAgICAgICAgAE=", -9223372036854775808L),
  ]
  for case in cases {
    let (b64, expected) = case
    assert_eq(decode_int64(b64), expected)
    assert_eq(encode_int64(expected), b64)
  }
}

///|
fn decode_uint32(b64 : String) -> UInt raise {
  let bytes = @protobuf.base64_decode(b64)
  let reader = @protobuf.BytesReader::from_bytes(bytes) as &@protobuf.Reader
  let (tag, wire_type) = reader |> @protobuf.read_tag()
  assert_eq(tag, 1U)
  assert_eq(wire_type, 0U)
  reader |> @protobuf.read_uint32()
}

///|
fn encode_uint32(value : UInt) -> String raise {
  let writer = @buffer.new()
  writer |> @protobuf.write_tag((1U, 0U))
  writer |> @protobuf.write_uint32(value)
  writer.to_bytes() |> @protobuf.base64_encode
}

///|
test "simple/uint32" {
  let cases : Array[(String, UInt)] = [
    ("CAA=", 0U),
    ("CAE=", 1U),
    ("CCo=", 42U),
    ("CH8=", 127U),
    ("CIAB", 128U),
    ("CP8B", 255U),
    ("CIAC", 256U),
    ("CIAI", 1024U),
    ("CP//Aw==", 65535U),
    ("CICABA==", 65536U),
    ("CP9/", 16383U),
    ("CICAAQ==", 16384U),
    ("CP//fw==", 2097151U),
    ("CICAgAE=", 2097152U),
    ("CP///38=", 268435455U),
    ("CICAgIAB", 268435456U),
    ("CIC8wZYL", 3000000000U),
    ("CIDQrPMO", 4000000000U),
    ("CP////8P", 4294967295U),
  ]
  for case in cases {
    let (b64, expected) = case
    assert_eq(decode_uint32(b64), expected)
    assert_eq(encode_uint32(expected), b64)
  }
}

///|
fn decode_uint64(b64 : String) -> UInt64 raise {
  let bytes = @protobuf.base64_decode(b64)
  let reader = @protobuf.BytesReader::from_bytes(bytes) as &@protobuf.Reader
  let (tag, wire_type) = reader |> @protobuf.read_tag()
  assert_eq(tag, 1U)
  assert_eq(wire_type, 0U)
  reader |> @protobuf.read_uint64()
}

///|
fn encode_uint64(value : UInt64) -> String raise {
  let writer = @buffer.new()
  writer |> @protobuf.write_tag((1U, 0U))
  writer |> @protobuf.write_uint64(value)
  writer.to_bytes() |> @protobuf.base64_encode
}

///|
test "simple/uint64" {
  let cases : Array[(String, UInt64)] = [
    ("CAA=", 0UL),
    ("CAE=", 1UL),
    ("CCo=", 42UL),
    ("CH8=", 127UL),
    ("CIAB", 128UL),
    ("CP8B", 255UL),
    ("CIAC", 256UL),
    ("CP9/", 16383UL),
    ("CICAAQ==", 16384UL),
    ("CP//fw==", 2097151UL),
    ("CICAgAE=", 2097152UL),
    ("CP///38=", 268435455UL),
    ("CICAgIAB", 268435456UL),
    ("CP////9/", 34359738367UL),
    ("CICAgICAAQ==", 34359738368UL),
    ("CP//////fw==", 4398046511103UL),
    ("CICAgICAgAE=", 4398046511104UL),
    ("CP///////38=", 562949953421311UL),
    ("CICAgICAgIAB", 562949953421312UL),
    ("CP////////9/", 72057594037927935UL),
    ("CICAgICAgICAAQ==", 72057594037927936UL),
    ("CICAgICAgIAQ", 9007199254740992UL),
    ("CICAoM/I4MjjigE=", 10000000000000000000UL),
    ("CP///////////wE=", 18446744073709551615UL),
  ]
  for case in cases {
    let (b64, expected) = case
    assert_eq(decode_uint64(b64), expected)
    assert_eq(encode_uint64(expected), b64)
  }
}

///|
fn decode_sint32(b64 : String) -> Int raise {
  let bytes = @protobuf.base64_decode(b64)
  let reader = @protobuf.BytesReader::from_bytes(bytes) as &@protobuf.Reader
  let (tag, wire_type) = reader |> @protobuf.read_tag()
  assert_eq(tag, 1U)
  assert_eq(wire_type, 0U)
  (reader |> @protobuf.read_sint32()).0
}

///|
fn encode_sint32(value : Int) -> String raise {
  let writer = @buffer.new()
  writer |> @protobuf.write_tag((1U, 0U))
  writer |> @protobuf.write_sint32(value)
  writer.to_bytes() |> @protobuf.base64_encode
}

///|
test "simple/sint32" {
  let cases : Array[(String, Int)] = [
    ("CAA=", 0),
    ("CAE=", -1),
    ("CAI=", 1),
    ("CAM=", -2),
    ("CAQ=", 2),
    ("CH4=", 63),
    ("CH0=", -63),
    ("CIAB", 64),
    ("CH8=", -64),
    ("CIAQ", 1024),
    ("CP8P", -1024),
    ("CP5/", 8191),
    ("CP1/", -8191),
    ("CICAAQ==", 8192),
    ("CP9/", -8192),
    ("CICJDw==", 123456),
    ("CP+IDw==", -123456),
    ("CP7///8P", 2147483647),
    ("CP////8P", -2147483648),
  ]
  for case in cases {
    let (b64, expected) = case
    assert_eq(decode_sint32(b64), expected)
    assert_eq(encode_sint32(expected), b64)
  }
}

///|
fn decode_sint64(b64 : String) -> Int64 raise {
  let bytes = @protobuf.base64_decode(b64)
  let reader = @protobuf.BytesReader::from_bytes(bytes) as &@protobuf.Reader
  let (tag, wire_type) = reader |> @protobuf.read_tag()
  assert_eq(tag, 1U)
  assert_eq(wire_type, 0U)
  (reader |> @protobuf.read_sint64()).0
}

///|
fn encode_sint64(value : Int64) -> String raise {
  let writer = @buffer.new()
  writer |> @protobuf.write_tag((1U, 0U))
  writer |> @protobuf.write_sint64(value)
  writer.to_bytes() |> @protobuf.base64_encode
}

///|
test "simple/sint64" {
  let cases : Array[(String, Int64)] = [
    ("CAA=", 0L),
    ("CAE=", -1L),
    ("CAI=", 1L),
    ("CAM=", -2L),
    ("CAQ=", 2L),
    ("CH4=", 63L),
    ("CH0=", -63L),
    ("CIAB", 64L),
    ("CH8=", -64L),
    ("CIAQ", 1024L),
    ("CP8P", -1024L),
    ("CP5/", 8191L),
    ("CP1/", -8191L),
    ("CICAAQ==", 8192L),
    ("CP9/", -8192L),
    ("CKq03nU=", 123456789L),
    ("CKm03nU=", -123456789L),
    ("CPL5t4+GkcED", 987654321012345L),
    ("CPH5t4+GkcED", -987654321012345L),
    ("CP7//////////wE=", 9223372036854775807L),
    ("CP///////////wE=", -9223372036854775808L),
  ]
  for case in cases {
    let (b64, expected) = case
    assert_eq(decode_sint64(b64), expected)
    assert_eq(encode_sint64(expected), b64)
  }
}

///|
fn decode_bool(b64 : String) -> Bool raise {
  let bytes = @protobuf.base64_decode(b64)
  let reader = @protobuf.BytesReader::from_bytes(bytes) as &@protobuf.Reader
  let (tag, wire_type) = reader |> @protobuf.read_tag()
  assert_eq(tag, 1U)
  assert_eq(wire_type, 0U)
  reader |> @protobuf.read_bool()
}

///|
fn encode_bool(value : Bool) -> String raise {
  let writer = @buffer.new()
  writer |> @protobuf.write_tag((1U, 0U))
  writer |> @protobuf.write_bool(value)
  writer.to_bytes() |> @protobuf.base64_encode
}

///|
test "simple/bool" {
  let cases : Array[(String, Bool)] = [("CAA=", false), ("CAE=", true)]
  for case in cases {
    let (b64, expected) = case
    assert_eq(decode_bool(b64), expected)
    assert_eq(encode_bool(expected), b64)
  }
}

///|
fn decode_enum(b64 : String) -> UInt raise {
  let bytes = @protobuf.base64_decode(b64)
  let reader = @protobuf.BytesReader::from_bytes(bytes) as &@protobuf.Reader
  let (tag, wire_type) = reader |> @protobuf.read_tag()
  assert_eq(tag, 1U)
  assert_eq(wire_type, 0U)
  (reader |> @protobuf.read_enum()).0
}

///|
fn encode_enum(value : UInt) -> String raise {
  let writer = @buffer.new()
  writer |> @protobuf.write_tag((1U, 0U))
  writer |> @protobuf.write_enum(@protobuf.Enum(value))
  writer.to_bytes() |> @protobuf.base64_encode
}

///|
test "simple/enum" {
  let cases : Array[(String, UInt)] = [
    ("CAA=", 0U),
    ("CAE=", 1U),
    ("CAI=", 2U),
    ("CP////8H", 2147483647U),
  ]
  for case in cases {
    let (b64, expected) = case
    assert_eq(decode_enum(b64), expected)
    assert_eq(encode_enum(expected), b64)
  }
}

///|
fn decode_fixed32(b64 : String) -> UInt raise {
  let bytes = @protobuf.base64_decode(b64)
  let reader = @protobuf.BytesReader::from_bytes(bytes) as &@protobuf.Reader
  let (tag, wire_type) = reader |> @protobuf.read_tag()
  assert_eq(tag, 1U)
  assert_eq(wire_type, 5U)
  reader |> @protobuf.read_fixed32()
}

///|
fn encode_fixed32(value : UInt) -> String raise {
  let writer = @buffer.new()
  writer |> @protobuf.write_tag((1U, 5U))
  writer |> @protobuf.write_fixed32(value)
  writer.to_bytes() |> @protobuf.base64_encode
}

///|
test "simple/fixed32" {
  let cases : Array[(String, UInt)] = [
    ("DQAAAAA=", 0U),
    ("DQEAAAA=", 1U),
    ("DXhWNBI=", 305419896U),
    ("Df///38=", 2147483647U),
    ("DQAAAIA=", 2147483648U),
    ("Df////8=", 4294967295U),
    ("De++rd4=", 3735928559U),
    ("Db66/so=", 3405691582U),
  ]
  for case in cases {
    let (b64, expected) = case
    assert_eq(decode_fixed32(b64), expected)
    assert_eq(encode_fixed32(expected), b64)
  }
}

///|
fn decode_fixed64(b64 : String) -> UInt64 raise {
  let bytes = @protobuf.base64_decode(b64)
  let reader = @protobuf.BytesReader::from_bytes(bytes) as &@protobuf.Reader
  let (tag, wire_type) = reader |> @protobuf.read_tag()
  assert_eq(tag, 1U)
  assert_eq(wire_type, 1U)
  reader |> @protobuf.read_fixed64()
}

///|
fn encode_fixed64(value : UInt64) -> String raise {
  let writer = @buffer.new()
  writer |> @protobuf.write_tag((1U, 1U))
  writer |> @protobuf.write_fixed64(value)
  writer.to_bytes() |> @protobuf.base64_encode
}

///|
test "simple/fixed64" {
  let cases : Array[(String, UInt64)] = [
    ("CQAAAAAAAAAA", 0UL),
    ("CQEAAAAAAAAA", 1UL),
    ("Ce/Nq4lnRSMB", 81985529216486895UL),
    ("Cf////////9/", 9223372036854775807UL),
    ("CQAAAAAAAACA", 9223372036854775808UL),
    ("Cf//////////", 18446744073709551615UL),
    ("CQHvzat4VjQS", 1311768467750121217UL),
    ("Ce++rd7vvq3e", 16045690984833335023UL),
  ]
  for case in cases {
    let (b64, expected) = case
    assert_eq(decode_fixed64(b64), expected)
    assert_eq(encode_fixed64(expected), b64)
  }
}

///|
fn decode_sfixed32(b64 : String) -> Int raise {
  let bytes = @protobuf.base64_decode(b64)
  let reader = @protobuf.BytesReader::from_bytes(bytes) as &@protobuf.Reader
  let (tag, wire_type) = reader |> @protobuf.read_tag()
  assert_eq(tag, 1U)
  assert_eq(wire_type, 5U)
  reader |> @protobuf.read_sfixed32()
}

///|
fn encode_sfixed32(value : Int) -> String raise {
  let writer = @buffer.new()
  writer |> @protobuf.write_tag((1U, 5U))
  writer |> @protobuf.write_sfixed32(value)
  writer.to_bytes() |> @protobuf.base64_encode
}

///|
test "simple/sfixed32" {
  let cases : Array[(String, Int)] = [
    ("DQAAAAA=", 0),
    ("DQEAAAA=", 1),
    ("Df////8=", -1),
    ("DRXNWwc=", 123456789),
    ("DesypPg=", -123456789),
    ("Df///38=", 2147483647),
    ("DQAAAIA=", -2147483648),
    ("DQA2ZcQ=", -1000000000),
  ]
  for case in cases {
    let (b64, expected) = case
    assert_eq(decode_sfixed32(b64), expected)
    assert_eq(encode_sfixed32(expected), b64)
  }
}

///|
fn decode_sfixed64(b64 : String) -> Int64 raise {
  let bytes = @protobuf.base64_decode(b64)
  let reader = @protobuf.BytesReader::from_bytes(bytes) as &@protobuf.Reader
  let (tag, wire_type) = reader |> @protobuf.read_tag()
  assert_eq(tag, 1U)
  assert_eq(wire_type, 1U)
  reader |> @protobuf.read_sfixed64()
}

///|
fn encode_sfixed64(value : Int64) -> String raise {
  let writer = @buffer.new()
  writer |> @protobuf.write_tag((1U, 1U))
  writer |> @protobuf.write_sfixed64(value)
  writer.to_bytes() |> @protobuf.base64_encode
}

///|
test "simple/sfixed64" {
  let cases : Array[(String, Int64)] = [
    ("CQAAAAAAAAAA", 0L),
    ("CQEAAAAAAAAA", 1L),
    ("Cf//////////", -1L),
    ("CXn+9jBEggMA", 987654321012345L),
    ("CYcBCc+7ffz/", -987654321012345L),
    ("Cf////////9/", 9223372036854775807L),
    ("CQAAAAAAAACA", -9223372036854775808L),
    ("CQAAnFhMSR/y", -1000000000000000000L),
  ]
  for case in cases {
    let (b64, expected) = case
    assert_eq(decode_sfixed64(b64), expected)
    assert_eq(encode_sfixed64(expected), b64)
  }
}

///|
fn decode_float_bits(b64 : String) -> UInt raise {
  let bytes = @protobuf.base64_decode(b64)
  let reader = @protobuf.BytesReader::from_bytes(bytes) as &@protobuf.Reader
  let (tag, wire_type) = reader |> @protobuf.read_tag()
  assert_eq(tag, 1U)
  assert_eq(wire_type, 5U)
  let value = reader |> @protobuf.read_float()
  value.reinterpret_as_uint()
}

///|
fn encode_float_bits(bits : UInt) -> String raise {
  let writer = @buffer.new()
  writer |> @protobuf.write_tag((1U, 5U))
  let value = Float::reinterpret_from_int(bits.reinterpret_as_int())
  writer |> @protobuf.write_float(value)
  writer.to_bytes() |> @protobuf.base64_encode
}

///|
test "simple/float" {
  let cases : Array[(String, UInt)] = [
    ("DQAAAAA=", 0U),
    ("DQAAgL8=", 3212836864U),
    ("DQAAwD8=", 1069547520U),
    ("DQAAEMA=", 3222274048U),
    ("DdsPSUA=", 1078530011U),
    ("DQjlPB4=", 507307272U),
    ("Dex4rWA=", 1621981420U),
    ("DQAAwH8=", 2143289344U),
    ("DQAAgH8=", 2139095040U),
    ("DQAAgP8=", 4286578688U),
  ]
  for case in cases {
    let (b64, expected) = case
    assert_eq(decode_float_bits(b64), expected)
    assert_eq(encode_float_bits(expected), b64)
  }
}

///|
fn decode_double_bits(b64 : String) -> UInt64 raise {
  let bytes = @protobuf.base64_decode(b64)
  let reader = @protobuf.BytesReader::from_bytes(bytes) as &@protobuf.Reader
  let (tag, wire_type) = reader |> @protobuf.read_tag()
  assert_eq(tag, 1U)
  assert_eq(wire_type, 1U)
  let value = reader |> @protobuf.read_double()
  value.reinterpret_as_uint64()
}

///|
fn encode_double_bits(bits : UInt64) -> String raise {
  let writer = @buffer.new()
  writer |> @protobuf.write_tag((1U, 1U))
  let value = Int64::reinterpret_as_double(bits.reinterpret_as_int64())
  writer |> @protobuf.write_double(value)
  writer.to_bytes() |> @protobuf.base64_encode
}

///|
test "simple/double" {
  let cases : Array[(String, UInt64)] = [
    ("CQAAAAAAAAAA", 0UL),
    ("CQAAAAAAAPC/", 13830554455654793216UL),
    ("CQAAAAAAAPg/", 4609434218613702656UL),
    ("CQAAAAAAAALA", 13835621005235585024UL),
    ("CRgtRFT7IQlA", 4614256656552045848UL),
    ("CVnz+MIfbqUB", 118622047889322841UL),
    ("CZx1AIg85Dd+", 9094988921128908188UL),
    ("CQAAAAAAAPh/", 9221120237041090560UL),
    ("CQAAAAAAAPB/", 9218868437227405312UL),
    ("CQAAAAAAAPD/", 18442240474082181120UL),
  ]
  for case in cases {
    let (b64, expected) = case
    assert_eq(decode_double_bits(b64), expected)
    assert_eq(encode_double_bits(expected), b64)
  }
}

///|
fn decode_bytes(b64 : String) -> Bytes raise {
  let bytes = @protobuf.base64_decode(b64)
  let reader = @protobuf.BytesReader::from_bytes(bytes) as &@protobuf.Reader
  let (tag, wire_type) = reader |> @protobuf.read_tag()
  assert_eq(tag, 1U)
  assert_eq(wire_type, 2U)
  reader |> @protobuf.read_bytes()
}

///|
fn encode_bytes(value : Bytes) -> String raise {
  let writer = @buffer.new()
  writer |> @protobuf.write_tag((1U, 2U))
  writer |> @protobuf.write_bytes(value)
  writer.to_bytes() |> @protobuf.base64_encode
}

///|
test "simple/bytes" {
  let cases : Array[(String, Bytes)] = [
    ("CgA=", b""),
    ("CgEA", b"\x00"),
    ("CgIBAg==", b"\x01\x02"),
    ("CgIA/w==", b"\x00\xff"),
    ("CgQA/xAg", b"\x00\xff\x10\x20"),
    ("CgUAAQIDBA==", b"\x00\x01\x02\x03\x04"),
    (
      "ChAAAQIDBAUGBwgJCgsMDQ4P", b"\x00\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f",
    ),
    ("CgTerb7v", b"\xde\xad\xbe\xef"),
    ("CggAAAAAAAAAAA==", b"\x00\x00\x00\x00\x00\x00\x00\x00"),
    (
      "Cgyrq6urq6urq6urq6s=", b"\xab\xab\xab\xab\xab\xab\xab\xab\xab\xab\xab\xab",
    ),
  ]
  for case in cases {
    let (b64, expected) = case
    assert_eq(decode_bytes(b64), expected)
    assert_eq(encode_bytes(expected), b64)
  }
}

///|
fn decode_string(b64 : String) -> String raise {
  let bytes = @protobuf.base64_decode(b64)
  let reader = @protobuf.BytesReader::from_bytes(bytes) as &@protobuf.Reader
  let (tag, wire_type) = reader |> @protobuf.read_tag()
  assert_eq(tag, 1U)
  assert_eq(wire_type, 2U)
  reader |> @protobuf.read_string()
}

///|
fn encode_string(value : String) -> String raise {
  let writer = @buffer.new()
  writer |> @protobuf.write_tag((1U, 2U))
  writer |> @protobuf.write_string(value)
  writer.to_bytes() |> @protobuf.base64_encode
}

///|
test "simple/string" {
  let cases : Array[(String, String)] = [
    ("CgA=", ""),
    ("CgFh", "a"),
    ("CgVoZWxsbw==", "hello"),
    ("Cgt3aXRoIHNwYWNlcw==", "with spaces"),
    (
      "CiNzeW1ib2xzICFAIyQlXiYqKClfK3t9fDo8Pj9bXVw7JywuLw==", "symbols !@#$%^&*()_+{}|:<>?[]\\;',./",
    ),
    ("CgpsaW5lCmJyZWFr", "line\nbreak"),
    ("Cgp0YWIJaW5kZW50", "tab\tindent"),
    ("Cg51bmljb2RlIOS4reaWhw==", "unicode 中文"),
    ("CgltaXhlZCAxMjM=", "mixed 123"),
    ("Cg9zbGFzaGVzIFxcIHBhdGg=", "slashes \\\\ path"),
  ]
  for case in cases {
    let (b64, expected) = case
    assert_eq(decode_string(b64), expected)
    assert_eq(encode_string(expected), b64)
  }
}
